unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Test Program ===
This program tests network access by attempting to:
1. Create a socket
2. Connect to 8.8.8.8:53

[TEST 1] Creating socket...
âŒ BLOCKED: socket() failed - Operation not permitted
âœ“ Firewall is working! Network syscalls are blocked.
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Test Program ===
This program tests network access by attempting to:
1. Create a socket
2. Connect to 8.8.8.8:53

[TEST 1] Creating socket...
âŒ BLOCKED: socket() failed - Operation not permitted
âœ“ Firewall is working! Network syscalls are blocked.
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
unshare: Operation not permitted
Failed to create network namespace
Warning: Some namespace setups failed
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Test Program ===
This program tests network access by attempting to:
1. Create a socket
2. Connect to 8.8.8.8:53

[TEST 1] Creating socket...
âŒ BLOCKED: socket() failed - Operation not permitted
âœ“ Firewall is working! Network syscalls are blocked.
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
unshare: Operation not permitted
Failed to create network namespace
Warning: Some namespace setups failed
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Firewall Test ===
Testing outbound connection attempts...

[Firewall Test] Trying HTTP (Google DNS) (8.8.8.8:80)... Failed: Operation now in progress
[Firewall Test] Trying HTTPS (Google DNS) (8.8.8.8:443)... CONNECTED (allowed)
[Firewall Test] Trying DNS (8.8.8.8:53)... CONNECTED (allowed)
[Firewall Test] Trying SSH (localhost) (127.0.0.1:22)... Connection refused (port closed)
[Firewall Test] Trying Telnet (dangerous) (127.0.0.1:23)... Connection refused (port closed)
[Firewall Test] Trying SMB (dangerous) (127.0.0.1:445)... Connection refused (port closed)

=== Summary ===
Connections allowed: 2
Connections blocked: 0
Total tests: 6
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate

[34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[0m[34mâ•‘     SANDBOX ENGINE FIREWALL AUTOMATED TEST SUITE          â•‘
[0m[34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m
Running 9 test cases...

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: NO_NETWORK Mode - Blocks Socket Creation[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: NO_NETWORK
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: STRICT Mode - Blocks Socket Creation[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: STRICT
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: STRICT Mode + Network Namespace - Still Blocks[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: STRICT
Network Namespace: ENABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: Network Namespace Only - Blocks External Network[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_connect
Firewall Policy: DISABLED
Network Namespace: ENABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 0
[31mâœ— FAIL: Network succeeded but should have been blocked[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: MODERATE Mode without NS - Limited Protection[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: MODERATE
Network Namespace: DISABLED
Expected Behavior: Network should [32mSUCCEED[0m

[33mâ–º Running test...[0m
Setting up PID namespace...
Landlock disabled - full file system access
Initializing firewall with policy: MODERATE
MODERATE mode: Rules configured, best used with Network Namespace
For complete network isolation, use NO_NETWORK or STRI=== Network Test Program ===
This program tests network access by attempting to:
1. Create a socket
2. Connect to 8.8.8.8:53

[TEST 1] Creating socket...
âœ“ socket() succeeded (fd=3)

[TEST 2] Attempting to connect to 8.8.8.8:53...
âœ“ connect() succeeded
âš  WARNING: Network access is ALLOWED! Firewall may not be active.

[34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[0m[34mâ•‘     SANDBOX ENGINE FIREWALL AUTOMATED TEST SUITE          â•‘
[0m[34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m
Running 9 test cases...

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: NO_NETWORK Mode - Blocks Socket Creation[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: NO_NETWORK
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: STRICT Mode - Blocks Socket Creation[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: STRICT
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: STRICT Mode + Network Namespace - Still Blocks[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: STRICT
Network Namespace: ENABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: Network Namespace Only - Blocks External Network[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_connect
Firewall Policy: DISABLED
Network Namespace: ENABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 0
[31mâœ— FAIL: Network succeeded but should have been blocked[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: MODERATE Mode without NS - Limited Protection[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: MODERATE
Network Namespace: DISABLED
Expected Behavior: Network should [32mSUCCEED[0m

[33mâ–º Running test...[0m

Program exit code: 0
[32mâœ“ PASS: Network operation succeeded (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
unshare: Operation not permitted
Failed to create network namespace
Warning: Some namespace setups failed
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Firewall Test ===
Testing outbound connection attempts...

[Firewall Test] Trying HTTP (Google DNS) (8.8.8.8:80)... Failed: Operation now in progress
[Firewall Test] Trying HTTPS (Google DNS) (8.8.8.8:443)... CONNECTED (allowed)
[Firewall Test] Trying DNS (8.8.8.8:53)... CONNECTED (allowed)
[Firewall Test] Trying SSH (localhost) (127.0.0.1:22)... Connection refused (port closed)
[Firewall Test] Trying Telnet (dangerous) (127.0.0.1:23)... Connection refused (port closed)
[Firewall Test] Trying SMB (dangerous) (127.0.0.1:445)... Connection refused (port closed)

=== Summary ===
Connections allowed: 2
Connections blocked: 0
Total tests: 6
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== HTTP Request Test Program ===
Attempting HTTP GET to http://example.com:80

[TEST 1] Creating socket...
âŒ BLOCKED: socket() failed - Operation not permitted
âœ“ Firewall blocked socket creation (NO_NETWORK mode)
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== DNS Lookup Test Program ===
Testing DNS resolution for multiple domains

[TEST 1] Looking up google.com...
âŒ DNS lookup failed: Temporary failure
   âœ“ Network namespace isolation or DNS blocking is active

[TEST 2] Looking up example.com...
âŒ DNS lookup failed: Temporary failure
   âœ“ Network namespace isolation or DNS blocking is active

[TEST 3] Looking up github.com...
âŒ DNS lookup failed: Temporary failure
   âœ“ Network namespace isolation or DNS blocking is active

[TEST 4] Looking up localhost...
âœ“ DNS lookup successful
   Official name: localhost
   IP addresses:
      127.0.0.1

=== Test Complete ===
If most DNS lookups failed, the firewall/network isolation is working.
If DNS works, check if firewall policy allows DNS (port 53 UDP).
unshare: Operation not permitted
Failed to create PID namespace
Warning: PID namespace setup failed, continuing without it
Warning: Failed to read real PID from pipe, monitoring may be inaccurate
=== Network Test Program ===
This program tests network access by attempting to:
1. Create a socket
2. Connect to 8.8.8.8:53

[TEST 1] Creating socket...
âœ“ socket() succeeded (fd=3)

[TEST 2] Attempting to connect to 8.8.8.8:53...
âœ“ connect() succeeded
âš  WARNING: Network access is ALLOWED! Firewall may not be active.
â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: MODERATE Mode + Network Namespace - Strong Protection[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_connect
Firewall Policy: MODERATE
Network Namespace: ENABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 0
[31mâœ— FAIL: Network succeeded but should have been blocked[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: NO_NETWORK Mode - Blocks HTTP Request[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/http_request
Firewall Policy: NO_NETWORK
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 1
[32mâœ“ PASS: Network operation blocked (as expected)[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: NO_NETWORK Mode - Blocks DNS Lookup[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/dns_lookup
Firewall Policy: NO_NETWORK
Network Namespace: DISABLED
Expected Behavior: Network should [31mFAIL[0m

[33mâ–º Running test...[0m

Program exit code: 0
[31mâœ— FAIL: Network succeeded but should have been blocked[0m

[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[34m  Test: DISABLED Firewall without NS - Allows Network (Baseline)[0m
[34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
Program: ./sample_programs/network_test
Firewall Policy: DISABLED
Network Namespace: DISABLED
Expected Behavior: Network should [32mSUCCEED[0m

[33mâ–º Running test...[0m

Program exit code: 0
[32mâœ“ PASS: Network operation succeeded (as expected)[0m

[34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[0m[34mâ•‘                    TEST RESULTS SUMMARY                   â•‘
[0m[34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m
Total Tests:  9
[32mâœ“ Passed:     6[0m
[31mâœ— Failed:     3[0m
[33mâŠ˜ Skipped:    0[0m
[31mâš  Errors:     0[0m

[31mFailed/Error Test Details:[0m
  â€¢ Network Namespace Only - Blocks External Network: Network succeeded but should have been blocked
  â€¢ MODERATE Mode + Network Namespace - Strong Protection: Network succeeded but should have been blocked
  â€¢ NO_NETWORK Mode - Blocks DNS Lookup: Network succeeded but should have been blocked

[31mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m[31m  âœ— SOME TESTS FAILED
[0m[31mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m
